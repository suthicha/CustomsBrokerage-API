{"version":3,"sources":["../../src/controller/company.js"],"names":["squel","require","db","httpMsg","helper","exports","getList","req","resp","sql","select","from","order","toString","executeSql","data","err","show500","sendJson","get","id","Error","where","ex","add","body","insert","into","set","StringNull","CustCode","TaxNumber","BranchNo","CustName","Street","District","SubProvince","Province","PostCode","Phone","CountryCode","Email","TagCode","update","table","TrxId","delete"],"mappings":"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","file":"company.js","sourcesContent":["var squel = require('squel');\nvar db = require('../core/db');\nvar httpMsg = require('../core/httpMsg');\nvar helper = require('../core/helper');\n\nexports.getList = function(req, resp) {\n    var sql = squel.select()\n        .from(\"DTM_Companies\")\n        .order(\"CustName\", true)\n        .toString();\n    \n    db.executeSql(sql, function(data, err) {\n        if (err){\n            httpMsg.show500(req, resp, err);\n        }\n        else{\n            httpMsg.sendJson(req, resp, data);\n        }\n    })\n}\n\nexports.get = function(req, resp, id){\n    try{\n        if (!id) throw new Error(\"Input not valid\");\n        var sql = squel.select()\n            .from(\"DTM_Companies\")\n            .where(\"TrxId = ?\", id)\n            .toString();\n        \n        db.executeSql(sql, function(data, err) {\n            if(err){\n                httpMsg.show500(req, resp, err);\n            }\n            else {\n                httpMsg.sendJson(req, resp, data);\n            }\n        })\n\n    }catch (ex) {\n        httpMsg.show500(req, resp, ex);\n    }\n}\n\nexports.add = function(req, resp) {\n    try{\n        if(!req.body) throw new Error(\"Input not valid\");\n        var data = req.body;\n\n        if (data){\n            var sql = squel.insert()\n                .into(\"DTM_Companies\")\n                .set(\"CustCode\", helper.StringNull(data.CustCode))\n                .set(\"TaxNumber\", helper.StringNull(data.TaxNumber))\n                .set(\"BranchNo\", helper.StringNull(data.BranchNo))\n                .set(\"CustName\", helper.StringNull(data.CustName))\n                .set(\"Street\", helper.StringNull(data.Street))\n                .set(\"District\", helper.StringNull(data.District))\n                .set(\"SubProvince\", helper.StringNull(data.SubProvince))\n                .set(\"Province\", helper.StringNull(data.Province))\n                .set(\"PostCode\", helper.StringNull(data.PostCode))\n                .set(\"Phone\", helper.StringNull(data.Phone))\n                .set(\"CountryCode\", helper.StringNull(data.CountryCode))\n                .set(\"Email\", helper.StringNull(data.Email))\n                .set(\"TagCode\", helper.StringNull(data.TagCode))\n                .set(\"CustStatus\", \"A\")\n                .toString();\n\n            db.executeSql(sql, function(data, err) {\n                if(err){\n                    httpMsg.show500(req, resp, err);\n                }\n                else {\n                    httpMsg.sendJson(req, resp, data);\n                }\n            })    \n\n        }\n\n    }catch (ex){\n        httpMsg.show500(req, resp, ex);\n    }\n}\n\nexports.update = function(req, resp) {\n    try{\n        if(!req.body) throw new Error(\"Input not valid\");\n        var data = req.body;\n\n        if (data){\n            var sql = squel.update()\n                .table(\"DTM_Companies\")\n                .set(\"CustCode\", helper.StringNull(data.CustCode))\n                .set(\"TaxNumber\", helper.StringNull(data.TaxNumber))\n                .set(\"BranchNo\", helper.StringNull(data.BranchNo))\n                .set(\"CustName\", helper.StringNull(data.CustName))\n                .set(\"Street\", helper.StringNull(data.Street))\n                .set(\"District\", helper.StringNull(data.District))\n                .set(\"SubProvince\", helper.StringNull(data.SubProvince))\n                .set(\"Province\", helper.StringNull(data.Province))\n                .set(\"PostCode\", helper.StringNull(data.PostCode))\n                .set(\"Phone\", helper.StringNull(data.Phone))\n                .set(\"CountryCode\", helper.StringNull(data.CountryCode))\n                .set(\"Email\", helper.StringNull(data.Email))\n                .set(\"TagCode\", helper.StringNull(data.TagCode))\n                .where(\"TrxId = ?\", data.TrxId)\n                .toString();\n\n            db.executeSql(sql, function(data, err) {\n                if(err){\n                    httpMsg.show500(req, resp, err);\n                }\n                else {\n                    httpMsg.sendJson(req, resp, data);\n                }\n            })    \n\n        }\n\n    }catch (ex){\n        httpMsg.show500(req, resp, ex);\n    }\n}\n\nexports.delete = function(req, resp) {\n    try{\n        if(!req.body) throw new Error(\"Input not valid\");\n        var data = req.body;\n\n        if (data){\n            var sql = squel.delete()\n                .from(\"DTM_Companies\")\n                .where(\"TrxId = ?\", data.TrxId)\n                .toString();\n\n            db.executeSql(sql, function(data, err) {\n                if(err){\n                    httpMsg.show500(req, resp, err);\n                }\n                else {\n                    httpMsg.sendJson(req, resp, data);\n                }\n            })    \n\n        }\n\n    }catch (ex){\n        httpMsg.show500(req, resp, ex);\n    }\n}"]}